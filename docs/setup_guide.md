# Setup Guide

## üõ†Ô∏è Pi Zero SKR Pico PUWinder Setup

**AI-Generated Documentation** - Last Updated: 2025-10-25 03:51:01

### üìã Prerequisites

#### Hardware Requirements
- Raspberry Pi Zero (or Zero W)
- SKR Pico v1.0 microcontroller
- BLDC motor with Hall sensor
- Stepper motor with TMC2209 driver
- UART connection between Pi Zero and Pico

#### Software Requirements
- Raspberry Pi OS (latest)
- Python 3.11+
- Pico SDK (for firmware compilation)
- CMake (for building firmware)

### üîß Hardware Setup

#### 1. Pi Zero Configuration
```bash
# Enable UART
sudo raspi-config
# Navigate to: Interfacing Options ‚Üí Serial
# Enable: Would you like a login shell to be accessible over serial? ‚Üí No
# Enable: Would you like the serial port hardware to be enabled? ‚Üí Yes
```

#### 2. UART Connection
```
Pi Zero          SKR Pico
GPIO 14 (TXD) ‚Üí  GPIO 1 (RX)
GPIO 15 (RXD) ‚Üê  GPIO 0 (TX)
GND           ‚Üí  GND
```

#### 3. Motor Connections
```
Spindle (BLDC):
- PWM: GPIO 24
- Enable: GPIO 21
- Direction: GPIO 4
- Brake: GPIO 3
- Hall Sensor: GPIO 22

Traverse (Stepper):
- Step: GPIO 6
- Direction: GPIO 5
- Enable: GPIO 7
- Home Switch: GPIO 16
```

### üíª Software Installation

#### 1. Pi Zero Setup
```bash
# Update system
sudo apt update && sudo apt upgrade -y

# Install Python dependencies
sudo apt install python3-serial python3-pip -y
pip3 install pyserial pytest

# Clone repository
git clone https://github.com/baztardo/Pi-Zero-SKR-Pico-PUWinder.git
cd Pi-Zero-SKR-Pico-PUWinder
```

#### 2. Pico Firmware Setup
```bash
# Install Pico SDK
git clone https://github.com/raspberrypi/pico-sdk.git
cd pico-sdk
git submodule update --init

# Set environment variable
export PICO_SDK_PATH=/path/to/pico-sdk

# Build firmware
cd pico_firmware
mkdir build && cd build
cmake ..
make -j4
```

### ‚öôÔ∏è Configuration

#### 1. Machine Configuration
Edit `pi_zero/machine.cfg` to match your hardware:

```ini
# Spindle Configuration
[spindle]
pin: gpio24          # PWM output
enable_pin: gpio21   # Enable pin
direction_pin: gpio4 # Direction control
brake_pin: gpio3     # Brake control
hall_pin: gpio22     # Hall sensor

# Traverse Configuration
[stepper_y]
step_pin: gpio6      # Step pin
dir_pin: gpio5       # Direction pin
enable_pin: !gpio7   # Enable pin
position_endstop: gpio16  # Home switch
```

#### 2. Test Configuration
```bash
# Test UART communication
python3 pi_zero/test_uart.py

# Test G-code commands
python3 pi_zero/test_gcode_safety.py

# Test comprehensive features
python3 pi_zero/test_comprehensive_features.py
```

### üß™ Testing

#### 1. Basic Connectivity Test
```bash
python3 pi_zero/test_uart.py
```

Expected output:
```
‚úÖ Opened /dev/serial0 @ 115200 baud
‚úÖ Received: 'PONG'
‚úÖ Received: Pico_Spindle_v1.0
```

#### 2. G-code Safety Test
```bash
python3 pi_zero/test_gcode_safety.py
```

Expected output:
```
‚úÖ M0 (feed hold) - OK
‚úÖ M1 (resume from hold) - OK
‚úÖ M112 (emergency stop) - OK
‚úÖ M999 (reset from emergency stop) - OK
```

#### 3. Comprehensive Feature Test
```bash
python3 pi_zero/test_comprehensive_features.py
```

### üöÄ Running the System

#### 1. Start the Main Controller
```bash
python3 pi_zero/main_controller.py
```

#### 2. Basic G-code Commands
```python
from main_controller import GCodeAPI

# Connect to Pico
api = GCodeAPI()
api.connect()

# Start spindle
api.set_spindle_rpm(500, 'CW')

# Move traverse
api.move_traverse(50.0, 1000.0)

# Stop spindle
api.stop_spindle()
```

### üîß Troubleshooting

#### Common Issues

1. **UART Communication Failed**
   - Check wiring connections
   - Verify UART is enabled in raspi-config
   - Check baud rate (115200)

2. **Firmware Not Responding**
   - Reflash Pico firmware
   - Check power supply
   - Verify UART pins

3. **Motor Not Moving**
   - Check motor connections
   - Verify enable pins
   - Check power supply

4. **Hall Sensor Not Working**
   - Check sensor wiring
   - Verify pull-up resistors
   - Check signal levels

### üìû Support

- **GitHub Issues**: [Report Issues](https://github.com/baztardo/Pi-Zero-SKR-Pico-PUWinder/issues)
- **Documentation**: [Project Docs](https://baztardo.github.io/Pi-Zero-SKR-Pico-PUWinder/)
- **CI/CD Status**: [GitHub Actions](https://github.com/baztardo/Pi-Zero-SKR-Pico-PUWinder/actions)

---
*This documentation is automatically generated by AI and updated on every push.*
